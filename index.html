<!-- index.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>A'tsimaani</title>

  <link rel="stylesheet" href="main.css" />
  <link rel="icon" type="image/x-icon" href="img/logo.ico">
</head>

<body>

  <!-- OFF-CANVAS MENU (2-column like Rijks) -->
  <nav class="menu" aria-label="Site menu" id="menu" aria-hidden="true">
    <div class="menu__inner">
      <div class="menu__grid">
        
        <!-- Left column: sections -->
        <div class="menu__col menu__col--left" aria-label="Menu sections">
          <p class="menu__title">A'tsimaani</p>
        
          <!-- Direct links (no subpages) -->
          <a class="menu__direct" href="program/">Program</a>
          <a class="menu__direct" href="registration/">Registration</a>
          <a class="menu__direct" href="theme/">Theme</a>
          <a class="menu__direct" href="contact/">Contact</a>
        
          <div class="menu__spacer"></div>
        
          <!-- Tabs only for sections WITH subpages -->
          <button class="menu__section is-active" type="button" data-section="keynotes" aria-current="true">
            Keynote speakers
          </button>
          <button class="menu__section" type="button" data-section="attendees">
            For attendees
          </button>
        </div>


        <!-- Right column: links for selected section -->
        <div class="menu__col menu__col--right" aria-label="Menu links">
          <p class="menu__goto">GO TO</p>
          <div class="menu__panel" id="menuPanel">
            <!-- Filled by JS -->
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Dim overlay (also used for search) -->
  <div class="overlay" id="overlay" tabindex="-1" aria-hidden="true"></div>

  <!-- SEARCH MODAL -->
  <div class="search" id="search" aria-hidden="true" role="dialog" aria-label="Search site">
    <div class="search__inner">
      <div class="search__top">
        <p class="search__title">Search</p>
        <button class="search__close" id="searchClose" type="button" aria-label="Close search">✕</button>
      </div>

      <label class="sr-only" for="searchInput">Search</label>
      <input
        id="searchInput"
        class="search__input"
        type="search"
        placeholder="Search the site…"
        autocomplete="off"
      />

      <div class="search__results" id="searchResults" aria-live="polite"></div>
    </div>
  </div>

  <!-- Everything that “pushes” right when menu opens -->
  <div class="layout" id="layout">

    <!-- TOP BAR -->
    <header class="topbar" id="topbar" role="banner">
      <div class="topbar__left">
        <button class="hamburger" id="hamburger" type="button" aria-controls="menu" aria-expanded="false">
          <span aria-hidden="true">☰</span>
          <span class="sr-only">Open menu</span>
        </button>

        <!-- Search icon (click opens modal) -->
        <button class="navicon" id="searchBtn" type="button" aria-label="Search">
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M10.5 3a7.5 7.5 0 1 0 4.61 13.42l4.24 4.24 1.41-1.41-4.24-4.24A7.5 7.5 0 0 0 10.5 3zm0 2a5.5 5.5 0 1 1 0 11 5.5 5.5 0 0 1 0-11z"/>
          </svg>
        </button>

        <a class="navlink" href="./" aria-current="page">Home</a>
      </div>

      <div class="topbar__right">
        <a class="navlink" href="#" data-nav="language">EN</a>
        <a class="navlink" href="about/">About</a>
      </div>
    </header>

    <!-- HERO -->
    <section class="hero" aria-label="Conference hero">
      <div class="hero-inner">
        <p class="kicker">Lethbridge • 2026</p>
        <h1 class="title">A'tsimaani</h1>
        <p class="subtitle">Slogan.</p>
      </div>
    </section>

    <!-- MAIN -->
    <main>
      <div class="wrap">
        <p class="blurb">
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum justo eros, eu maximus 
          felis sodales non. Sed vitae sagittis lacus, et suscipit tortor. Curabitur vulputate venenatis nibh, et 
          egestas erat molestie vel. Cras lobortis tempor elit sit amet auctor. Phasellus non bibendum nisi. Curabitur 
          congue, nunc fringilla vehicula blandit, lorem ante luctus nibh, eu mattis enim elit at dolor. Nam ornare in 
          nulla a elementum. Sed condimentum consectetur ultrices. Fusce velit massa, dictum ac risus faucibus, egestas 
          pretium nibh.
        </p>

        <h2 class="section-title">Explore</h2>

        <div class="cards">
          <a class="card" href="keynote-speakers/">
            <div class="card-media" style='background-image:url("assets/card-keynotes.jpg")'></div>
            <div class="card-body">
              <h3 class="card-title">Keynote speakers</h3>
              <p class="card-text">Meet the keynote speakers and see their abstracts and bios.</p>
              <div class="card-meta"><span>Speakers</span><span aria-hidden="true">→</span></div>
            </div>
          </a>

          <a class="card" href="for-attendees/">
            <div class="card-media" style='background-image:url("assets/card-attendees.jpg")'></div>
            <div class="card-body">
              <h3 class="card-title">For attendees</h3>
              <p class="card-text">Travel info, accommodations, accessibility, and support.</p>
              <div class="card-meta"><span>Practical info</span><span aria-hidden="true">→</span></div>
            </div>
          </a>

          <a class="card" href="program/">
            <div class="card-media" style='background-image:url("assets/card-program.jpg")'></div>
            <div class="card-body">
              <h3 class="card-title">Program</h3>
              <p class="card-text">Browse the schedule, sessions, and events.</p>
              <div class="card-meta"><span>Schedule</span><span aria-hidden="true">→</span></div>
            </div>
          </a>

          <a class="card" href="registration/">
            <div class="card-media" style='background-image:url("assets/card-registration.jpg")'></div>
            <div class="card-body">
              <h3 class="card-title">Registration</h3>
              <p class="card-text">Register, fees, deadlines, and confirmation details.</p>
              <div class="card-meta"><span>Sign up</span><span aria-hidden="true">→</span></div>
            </div>
          </a>
        </div>
      </div>
    </main>

    <!-- SIMPLE FOOTER -->
    <footer class="site-footer">
      <div class="footer-inner">
        <p class="footer-text">© <span id="year"></span> Conference Name. All rights reserved.</p>
        <a class="footer-contact" href="contact/">Contact</a>
      </div>
    </footer>

  </div><!-- /.layout -->

  <script>
    /***************
     * MENU (2-col)
     ***************/
    const body = document.body;
    const hamburger = document.getElementById('hamburger');
    const overlay = document.getElementById('overlay');
    const menu = document.getElementById('menu');
    const menuPanel = document.getElementById('menuPanel');
    const sections = Array.from(document.querySelectorAll('.menu__section'));

    // Define menu content for the right column
    const menuData = {
      program: {
        heading: "Program",
        links: [
          { label: "Go to Program", href: "program/" }
          // later: { label: "Schedule", href: "program/schedule/" }
        ]
      },
      theme: {
        heading: "Theme",
        links: [
          { label: "Go to Theme", href: "theme/" }
        ]
      },
      registration: {
        heading: "Registration",
        links: [
          { label: "Go to Registration", href: "registration/" }
        ]
      },
      contact: {
        heading: "Contact",
        links: [
          { label: "Go to Contact", href: "contact/" }
        ]
      },
      keynotes: {
        heading: "Keynote speakers",
        links: [
          { label: "All keynote speakers", href: "keynote-speakers/" }
          // later: { label: "Speaker Name", href: "keynote-speakers/speaker-name/" }
        ]
      },
      attendees: {
        heading: "For attendees",
        links: [
          { label: "Overview", href: "for-attendees/" },
          { label: "Accommodations", href: "for-attendees/accommodations/" },
          { label: "Financial support", href: "for-attendees/financial-support/" }
        ]
      }
    };

    function renderMenuPanel(key) {
      const data = menuData[key] || { heading: "", links: [] };
      const html = `
        <p class="menu__panelTitle">${data.heading}</p>
        <div class="menu__links">
          ${data.links.map(l => `<a class="menu__linkItem" href="${l.href}">${l.label}</a>`).join("")}
        </div>
      `;
      menuPanel.innerHTML = html;
    }

    function setActiveSection(btn) {
      sections.forEach(b => {
        b.classList.remove('is-active');
        b.removeAttribute('aria-current');
      });
      btn.classList.add('is-active');
      btn.setAttribute('aria-current', 'true');
      renderMenuPanel(btn.dataset.section);
    }

    // Initialize panel to first active
    const initial = document.querySelector('.menu__section.is-active') || sections[0];
    if (initial) renderMenuPanel(initial.dataset.section);

    sections.forEach(btn => {
      btn.addEventListener('click', () => setActiveSection(btn));
    });

    function setMenu(open){
      body.classList.toggle('menu-open', open);
      hamburger.setAttribute('aria-expanded', String(open));
      menu.setAttribute('aria-hidden', String(!open));

      if(open){
        sections[0]?.focus();
      }else{
        hamburger.focus();
      }
    }

    hamburger.addEventListener('click', () => setMenu(!body.classList.contains('menu-open')));
    overlay.addEventListener('click', () => {
      // overlay closes menu and search
      setMenu(false);
      setSearch(false);
    });

    window.addEventListener('keydown', (e) => {
      if(e.key === 'Escape'){
        if (body.classList.contains('menu-open')) setMenu(false);
        if (!document.getElementById('search').getAttribute('aria-hidden') === 'true') setSearch(false);
        setSearch(false);
      }
    });

    /*********************
     * HEADER: show on up
     *********************/
    const topbar = document.getElementById('topbar');
    let lastScrollY = window.scrollY;
    let hidden = false;

    function updateHeader(){
      const y = window.scrollY;
      const delta = y - lastScrollY;

      // don't hide when menu/search is open
      if (body.classList.contains('menu-open') || body.classList.contains('search-open')) {
        topbar.classList.remove('topbar--hidden');
        hidden = false;
        lastScrollY = y;
        return;
      }

      // small dead zone prevents flicker
      if (Math.abs(delta) < 8) return;

      // only start hiding after some scroll
      const past = y > 120;

      if (past && delta > 0 && !hidden) {
        topbar.classList.add('topbar--hidden');
        hidden = true;
      } else if (delta < 0 && hidden) {
        topbar.classList.remove('topbar--hidden');
        hidden = false;
      }

      lastScrollY = y;
    }

    window.addEventListener('scroll', () => {
      window.requestAnimationFrame(updateHeader);
    }, { passive: true });

    /********
     * SEARCH
     ********/
    const searchBtn = document.getElementById('searchBtn');
    const search = document.getElementById('search');
    const searchClose = document.getElementById('searchClose');
    const searchInput = document.getElementById('searchInput');
    const searchResults = document.getElementById('searchResults');

    // Minimal search index (add more entries as you add pages)
    const searchIndex = [
      { title: "Home", url: "./", keywords: "conference homepage" },
      { title: "About", url: "about/", keywords: "about theme mission" },
      { title: "Program", url: "program/", keywords: "schedule sessions panels" },
      { title: "Registration", url: "registration/", keywords: "register fees deadlines" },
      { title: "Contact", url: "contact/", keywords: "email contact" },
      { title: "Keynote speakers", url: "keynote-speakers/", keywords: "keynotes speakers" },
      { title: "For attendees", url: "for-attendees/", keywords: "travel accessibility accommodations support" },
      { title: "Accommodations", url: "for-attendees/accommodations/", keywords: "hotel lodging stay" },
      { title: "Financial support", url: "for-attendees/financial-support/", keywords: "funding bursary travel grant" }
    ];

    function setSearch(open){
      body.classList.toggle('search-open', open);
      search.setAttribute('aria-hidden', String(!open));
      topbar.classList.remove('topbar--hidden');

      if(open){
        searchInput.value = "";
        searchResults.innerHTML = "";
        searchInput.focus();
      }else{
        searchBtn.focus();
      }
    }

    function runSearch(q){
      const query = q.trim().toLowerCase();
      if(!query){
        searchResults.innerHTML = "";
        return;
      }

      const results = searchIndex.filter(item => {
        const hay = (item.title + " " + item.keywords).toLowerCase();
        return hay.includes(query);
      }).slice(0, 12);

      if(results.length === 0){
        searchResults.innerHTML = `<p class="search__empty">No results for “${escapeHtml(q)}”.</p>`;
        return;
      }

      searchResults.innerHTML = `
        <ul class="search__list">
          ${results.map(r => `
            <li class="search__item">
              <a class="search__link" href="${r.url}">${escapeHtml(r.title)}</a>
              <span class="search__url">${escapeHtml(r.url)}</span>
            </li>
          `).join("")}
        </ul>
      `;
    }

    function escapeHtml(str){
      return String(str).replace(/[&<>"']/g, s => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
      }[s]));
    }

    searchBtn.addEventListener('click', () => setSearch(true));
    searchClose.addEventListener('click', () => setSearch(false));

    searchInput.addEventListener('input', (e) => runSearch(e.target.value));

    /********
     * Footer year
     ********/
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>

</body>
</html>
